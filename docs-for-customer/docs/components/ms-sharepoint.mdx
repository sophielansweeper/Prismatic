---
id: ms-sharepoint
title: Microsoft SharePoint Component
sidebar_label: Microsoft SharePoint
description: Interact with sites, drives, and items connected to your instance of Microsoft SharePoint.. Learn more about using Prismatic's Microsoft SharePoint component.
---

[//]: # "DO NOT EDIT THIS FILE MANUALLY."
[//]: # "This file was auto generated using scripts in docusaurus/scripts/components/"

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

<div className="avatar">
  <div className="avatar__photo-link avatar__photo avatar__photo--lg">
    <img
      src="/docs/img/components/icons/60/bXMtc2hhcmVwb2ludA==.png"
      alt="Microsoft SharePoint"
    />
  </div>
  <div className="avatar__intro">
    <h4 className="avatar__name">
      Interact with sites, drives, and items connected to your instance of
      Microsoft SharePoint.
    </h4>
    <small className="avatar__subtitle">
      Component key: <b>ms-sharepoint</b>
    </small>
  </div>
</div>

## Description

[Microsoft SharePoint](https://www.microsoft.com/en-us/microsoft-365/sharepoint/collaboration?ms.officeurl=sharepoint&rtc=1) is a web-based collaborative platform that integrates with Microsoft Office.
This component allows you to interact with your sites, drives, and items by making queries through the Microsoft Graph API.

## Example SharePoint Integration

The examples repo has an example integration that you can [import](integrations.mdx/#importing-an-integration) that demonstrates how to listen for changes to a SharePoint drive, or fetch lists and items from a SharePoint site.

<ExampleIntegrationLink
  href="https://github.com/prismatic-io/examples/blob/main/integrations/sharepoint.yml"
  text="Example SharePoint Integration"
/>

This example integration contains five flows:

- **Import SharePoint File on Event** -
  Whenever a file is created/updated/deleted in your customer's selected Sharepoint drive, that file is fetched and uploaded to an "Acme" endpoint that your customer enters.
- **Subscribe to SharePoint File Events** -
  This flow runs every week and creates a subscription to a Sharepoint drive, instructing Sharepoint to send notifications to the **Import SharePoint File on Event** flow whenever files are updated.
- **Run Subscription Flow on Deploy** -
  This flow calls the **Subscribe to SharePoint File Events** once on instance deploy to ensure the subscription is configured immediately.
- **Get Files from SharePoint** -
  This is a synchronous flow that can be called from an external system to list files in a SharePoint drive.
- **Fetch Events and Documents from Site Lists** -
  This flow demonstrates how to fetch "lists" in a SharePoint site,.
  A "list" can represent a calendar of events or a directory with files in it.

## Connections

### Microsoft SharePoint OAuth 2.0

Once you have an instance of Microsoft SharePoint licensed to your account, you will need to create and configure a new "App Registration" within your [Azure Active Directory tenant](https://portal.azure.com/#home).
When creating the application you will be prompted to select the 'Supported account types'. Under this section, be sure to select 'Accounts in any organizational directory (Any Azure AD directory - Multitenant)'.

You will need to go to "Platforms" and add the "Web" platform. In that section you should add Prismatic's OAuth 2.0 callback URL - https<!---->://oauth2.prismatic.io/callback - as a **Redirect URI**.

Next, go to "Certificates & Secrets" for the app and add a new **Client Secret**. Note this value as you will need to supply it to the connection within Prismatic.

You will also need the **Application (client) ID** from the "Overview" page.

The last step of configuring the "App Registration" is assigning "App Permissions". Click "Add Permission", click on the square labeled "SharePoint", and then "Delegated permissions". You should select all permissions that are required for your desired integration.

Now, configure the OAuth 2.0 connection in Prismatic.
Add an MS SharePoint OAuth 2.0 connection config variable:

- Use the **Application (client) ID** value for the **Client ID** field.
- Use the **Client Secret** for the same named field.
- If you didn't select Multitenant when creating the Azure application, you will need to replace the **Authorize URL** and **Token URL** with ones specific to your tenant.

Save your integration and you should be able to authenticate a user through MS SharePoint with OAuth 2.0.

<ComponentInputsTable
  inputs={[
    {
      placeholder: "Authorize URL",
      required: true,
      shown: true,
      comments: "Provide a tenant specific OAuth 2.0 authorize endpoint.",
      key: "authorizeUrl",
      type: "string",
      default: "https://login.microsoftonline.com/common/oauth2/v2.0/authorize",
      label: "Authorize URL",
    },
    {
      placeholder: "Client ID",
      required: true,
      shown: true,
      comments: "Client Id of your Azure application",
      key: "clientId",
      type: "string",
      default: "",
      label: "Client ID",
    },
    {
      placeholder: "Client Secret",
      required: true,
      shown: true,
      comments:
        "Client Secret generated under 'Certificates & Secrets' in your Azure application.",
      key: "clientSecret",
      type: "password",
      default: "",
      label: "Client Secret",
    },
    {
      placeholder: "Scopes",
      required: true,
      shown: true,
      comments: "Space separated OAuth 2.0 permission scopes",
      key: "scopes",
      type: "string",
      default: "Sites.ReadWrite.All Sites.Manage.All offline_access",
      label: "Scopes",
    },
    {
      placeholder: "Token URL",
      required: true,
      shown: true,
      comments: "Provide a tenant specific OAuth 2.0 token endpoint.",
      key: "tokenUrl",
      type: "string",
      default: "https://login.microsoftonline.com/common/oauth2/v2.0/token",
      label: "Token URL",
    },
  ]}
/>

## Triggers

<div id="webhook" />

### Webhook

Receive and validate webhook requests from Sharepoint for webhooks you configure. | <small><b>key: webhook</b></small>

<ComponentInputsTable inputs={[]} />

<hr className="componentActionSeparator" />

## Data Sources

<div id="listdrives" />

### List Drives from Source

A picklist of files in a given directory | <small><b>key: listDrives</b></small> | <small><b>type: picklist</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: false,
      comments:
        "Retrieve the list of Drive resources available for a target User, Group, or Site. https://learn.microsoft.com/en-us/graph/api/drive-list?view=graph-rest-1.0&tabs=http",
      example: "/groups/{groupId}/drives",
      key: "dir",
      type: "string",
      default: "/groups/{groupId}/drives",
      label: "Directory",
    },
  ]}
/>

<hr className="componentActionSeparator" />

<div id="listfolders" />

### List Folders from Source

A picklist of folders in a given directory | <small><b>key: listFolders</b></small> | <small><b>type: picklist</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: false,
      comments:
        "Retrieve the list of Drive resources available for a target User, Group, or Site. https://learn.microsoft.com/en-us/graph/api/drive-list?view=graph-rest-1.0&tabs=http",
      example: "/groups/{groupId}/drives",
      key: "dir",
      type: "string",
      default: "/groups/{groupId}/drives",
      label: "Directory",
    },
  ]}
/>

<hr className="componentActionSeparator" />

<div id="listsites" />

### List Sites from Sharepoint

A picklist of Sites | <small><b>key: listSites</b></small> | <small><b>type: picklist</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
  ]}
/>

<hr className="componentActionSeparator" />

## Actions

<div id="createsubscription" />

### Create a Subscription

Create a Subscription to notify you of changes to a resource | <small><b>key: createSubscription</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: false,
      comments: "Enable to allow more than one subscription per endpoint",
      key: "allowDuplicates",
      type: "boolean",
      default: false,
      label: "Allow Duplicates",
    },
    {
      required: true,
      comments:
        "The type of changes that should generate notifications for this subscription. OneDrive only supports updated.",
      example: "updated",
      key: "changeType",
      type: "string",
      default: "updated",
      label: "Change Type",
    },
    {
      required: false,
      comments:
        "An optional string value that is passed back in the notification message for this subscription.",
      example: "client-specific string",
      key: "clientState",
      type: "string",
      default: "",
      label: "Client State",
    },
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments:
        "The date and time when the subscription will expire if not updated or renewed.",
      example: "2018-01-01T11:23:00.000Z",
      key: "expirationDateTime",
      type: "string",
      default: "",
      label: "Expiration Date Time",
    },
    {
      required: true,
      comments:
        "The URL that notifications should be delivered to, if required for the specified notificationType.",
      example: "https://contoso.azurewebsites.net/api/webhook-receiver",
      key: "notificationUrl",
      type: "string",
      default: "",
      label: "Notification URL",
    },
    {
      required: true,
      comments:
        "The relative path of the subscription within the drive. Read-only.",
      example: "/me/drive/root",
      key: "resource",
      type: "string",
      default: "",
      label: "Resource",
    },
  ]}
/>

#### Output Example Payload

```
{
  "data": {
    "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#subscriptions/$entity",
    "id": "38031b7d-16b1-448a-8e68-68b8aec62315",
    "resource": "/me/drive/root",
    "applicationId": "0fed8223-8c47-4c71-ba78-92c6f9448725",
    "changeType": "updated",
    "clientState": "client-specific string",
    "notificationUrl": "https://hooks.prismatic.io/trigger/SW5z",
    "notificationQueryOptions": null,
    "lifecycleNotificationUrl": null,
    "expirationDateTime": "2023-07-01T11:23:00Z",
    "creatorId": "6219df3c-04d4-4b39-b2a4-ad162a5dcb8f",
    "includeResourceData": null,
    "latestSupportedTlsVersion": "v1_2",
    "encryptionCertificate": null,
    "encryptionCertificateId": null,
    "notificationUrlAppId": null
  }
}
```

<hr className="componentActionSeparator" />

<div id="createiteminsite" />

### Create Item in Site List

Create a new item inside the given site list | <small><b>key: createItemInSite</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments:
        "For each item, provide a key value pair to be added to the new drive item's properties.",
      key: "fields",
      type: "string",
      default: "",
      collection: "keyvaluelist",
      label: "Fields",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint site list.",
      example: "48bf81d7-2d37-40a9-b47b-c1d1960d00f87",
      key: "listId",
      type: "string",
      default: "",
      label: "List Id",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint site.",
      example:
        "example.sharepoint.com,c45de8832-a4969-479d-aeb2-7nAh8321,48bf81d7-2d37-40a9-b47b-c1d1960d00f87",
      key: "siteId",
      type: "string",
      default: "",
      label: "Site Id",
    },
  ]}
/>

<hr className="componentActionSeparator" />

<div id="createsitelistsubscription" />

### Create Site List Subscription

Create a Site List subscription for Microsoft SharePoint | <small><b>key: createSiteListSubscription</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: false,
      comments: "Enable to allow more than one webhook per endpoint",
      key: "allowDuplicates",
      type: "boolean",
      default: "false",
      label: "Allow Duplicates",
    },
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: false,
      comments:
        "Expiration date/time for subscription. If unspecified the default will be the current date/time plus 29 days (close to the maximum permitted by the Graph API).",
      key: "expirationDateTime",
      type: "string",
      default: "",
      label: "Expiration Date/Time",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint site list.",
      example: "48bf81d7-2d37-40a9-b47b-c1d1960d00f87",
      key: "listId",
      type: "string",
      default: "",
      label: "List Id",
    },
    {
      required: true,
      comments: "URL to send events of this Subscription to",
      key: "notificationUrl",
      type: "string",
      default: "",
      label: "Notification URL",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint site.",
      example:
        "example.sharepoint.com,c45de8832-a4969-479d-aeb2-7nAh8321,48bf81d7-2d37-40a9-b47b-c1d1960d00f87",
      key: "siteId",
      type: "string",
      default: "",
      label: "Site Id",
    },
  ]}
/>

#### Output Example Payload

```
{
  "data": {
    "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#subscriptions/$entity",
    "id": "e9d5b726-4478-4412-bfba-268530484566",
    "resource": "sites/example.sharepoint.com,17cd4ada-1a76-420e-a7ec-4adaa3327c86,87742bc7-2d2f-404c-8255-d3d9fa9a6561/lists/3a3c0f6a-86da-4567-94d4-3b939da63200",
    "applicationId": "e76615c0-13e3-4cd2-8235-a2d628ad13de",
    "changeType": "updated",
    "clientState": null,
    "notificationUrl": "https://example.com/webhook/",
    "notificationQueryOptions": null,
    "lifecycleNotificationUrl": null,
    "expirationDateTime": "2022-11-22T23:32:10.231Z",
    "creatorId": "c8edbeda-c453-446c-91ce-c6d5c7310a6c",
    "includeResourceData": null,
    "latestSupportedTlsVersion": "v1_2",
    "encryptionCertificate": null,
    "encryptionCertificateId": null,
    "notificationUrlAppId": null
  }
}
```

<hr className="componentActionSeparator" />

<div id="deletesubscription" />

### Delete a Subscription

Delete a Subscription by ID | <small><b>key: deleteSubscription</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments: "The Id the subscription to delete",
      example: "48bf81d7-2d37-40a9-b47b-c1d1960d00f87",
      key: "subscriptionId",
      type: "string",
      default: "",
      label: "Subscription Id",
    },
  ]}
/>

#### Output Example Payload

```
{
  "data": ""
}
```

<hr className="componentActionSeparator" />

<div id="deleteallinstancesubscriptions" />

### Delete All Instance Subscriptions

Delete all subscriptions pointed at this instance | <small><b>key: deleteAllInstanceSubscriptions</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
  ]}
/>

#### Output Example Payload

```
{
  "data": {
    "subscriptionsRemoved": [
      "26ebd1e9-c54a-4bbe-9583-fc05974952a4",
      "b9b27172-ee2e-4248-86df-fc98cb71d914"
    ]
  }
}
```

<hr className="componentActionSeparator" />

<div id="downloadfile" />

### Download File

Download a file from the specified drive | <small><b>key: downloadFile</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint drive.",
      example:
        "b!WumF-zsD8ku93Y0QqhKM9jVTjPefo6RGrpVCkPpe547Qrf38sox_TYIFuj9sqJhv",
      key: "driveId",
      type: "string",
      default: "",
      label: "Drive",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint item Id.",
      example: "01Q7VXROAW7LCB32ODBRCKZNSJIC544XAQ",
      key: "itemId",
      type: "string",
      default: "",
      label: "Item Id",
    },
  ]}
/>

<hr className="componentActionSeparator" />

<div id="getcurrentuser" />

### Get Current User

Get the information and metadata of the user that is currently logged in | <small><b>key: getCurrentUser</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
  ]}
/>

#### Output Example Payload

```
{
  "data": {
    "businessPhones": [
      "+1 555 555 5555"
    ],
    "displayName": "exampleUser",
    "givenName": "exampleUser",
    "jobTitle": "Retail Manager",
    "mail": "someoneV@example.onmicrosoft.com",
    "mobilePhone": "+1 555 555 5555",
    "officeLocation": "example",
    "preferredLanguage": "en-US",
    "surname": "Example",
    "id": "3693-4789-a1c3-f4de565f"
  }
}
```

<hr className="componentActionSeparator" />

<div id="getdrive" />

### Get Drive

Returns the information and metadata of a SharePoint drive | <small><b>key: getDrive</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint drive.",
      example:
        "b!WumF-zsD8ku93Y0QqhKM9jVTjPefo6RGrpVCkPpe547Qrf38sox_TYIFuj9sqJhv",
      key: "driveId",
      type: "string",
      default: "",
      label: "Drive",
    },
  ]}
/>

<hr className="componentActionSeparator" />

<div id="getfile" />

### Get File

Get a file from a Drive | <small><b>key: getFile</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint drive.",
      example:
        "b!WumF-zsD8ku93Y0QqhKM9jVTjPefo6RGrpVCkPpe547Qrf38sox_TYIFuj9sqJhv",
      key: "driveId",
      type: "string",
      default: "",
      label: "Drive",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint item Id.",
      example: "01Q7VXROAW7LCB32ODBRCKZNSJIC544XAQ",
      key: "itemId",
      type: "string",
      default: "",
      label: "Item Id",
    },
  ]}
/>

<hr className="componentActionSeparator" />

<div id="getiteminsite" />

### Get Item from Site List

Returns the information and metadata of the given item | <small><b>key: getItemInSite</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint item Id.",
      example: "01Q7VXROAW7LCB32ODBRCKZNSJIC544XAQ",
      key: "itemId",
      type: "string",
      default: "",
      label: "Item Id",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint site list.",
      example: "48bf81d7-2d37-40a9-b47b-c1d1960d00f87",
      key: "listId",
      type: "string",
      default: "",
      label: "List Id",
    },
    {
      required: false,
      example: "name, description, id",
      comments:
        "Provide a comma separated list of fields to overwrite the default result set.",
      key: "optInFields",
      type: "string",
      default: "",
      label: "Opt In Fields",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint site.",
      example:
        "example.sharepoint.com,c45de8832-a4969-479d-aeb2-7nAh8321,48bf81d7-2d37-40a9-b47b-c1d1960d00f87",
      key: "siteId",
      type: "string",
      default: "",
      label: "Site Id",
    },
  ]}
/>

<hr className="componentActionSeparator" />

<div id="getrootsite" />

### Get Root Site

Returns the information and metadata of the root SharePoint site in your tenant | <small><b>key: getRootSite</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
  ]}
/>

#### Output Example Payload

```
{
  "data": {
    "description": "Example description",
    "id": "example.sharepoint.com,c45e332-a998-479d-aeb2-2a",
    "name": "Example SharePoint Site",
    "webUrl": "https://example.sharepoint.com",
    "displayName": "Communication Site",
    "siteCollection": {
      "hostname": "https://example.sharepoint.com"
    }
  }
}
```

<hr className="componentActionSeparator" />

<div id="getsite" />

### Get Site

Returns the information and metadata of the given SharePoint site | <small><b>key: getSite</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint site.",
      example:
        "example.sharepoint.com,c45de8832-a4969-479d-aeb2-7nAh8321,48bf81d7-2d37-40a9-b47b-c1d1960d00f87",
      key: "siteId",
      type: "string",
      default: "",
      label: "Site Id",
    },
  ]}
/>

#### Output Example Payload

```
{
  "data": {
    "description": "Example description",
    "id": "example.sharepoint.com,c45e332-a998-479d-aeb2-2a",
    "name": "Example SharePoint Site",
    "webUrl": "https://example.sharepoint.com",
    "displayName": "Communication Site",
    "siteCollection": {
      "hostname": "https://example.sharepoint.com"
    }
  }
}
```

<hr className="componentActionSeparator" />

<div id="getlist" />

### Get Site List

Returns the information and metadata of an existing site list | <small><b>key: getList</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint site list.",
      example: "48bf81d7-2d37-40a9-b47b-c1d1960d00f87",
      key: "listId",
      type: "string",
      default: "",
      label: "List Id",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint site.",
      example:
        "example.sharepoint.com,c45de8832-a4969-479d-aeb2-7nAh8321,48bf81d7-2d37-40a9-b47b-c1d1960d00f87",
      key: "siteId",
      type: "string",
      default: "",
      label: "Site Id",
    },
  ]}
/>

<hr className="componentActionSeparator" />

<div id="listchanges" />

### List Changes

Track changes in a driveItem and its children over time. | <small><b>key: listChanges</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: false,
      comments:
        "Retrieves related resources. https://learn.microsoft.com/en-us/graph/query-parameters?tabs=http#expand-parameter",
      example: "members",
      key: "$expand",
      type: "string",
      default: "",
      label: "$expand Parameter",
    },
    {
      required: false,
      comments:
        "Filters properties (columns). https://learn.microsoft.com/en-us/graph/query-parameters?tabs=http#select-parameter",
      example: "givenName,surname",
      key: "$select",
      type: "string",
      default: "",
      label: "$select Parameter",
    },
    {
      required: false,
      comments:
        "Sets the page size of results.\thttps://learn.microsoft.com/en-us/graph/query-parameters?tabs=http#top-parameter",
      example: "5",
      key: "$top",
      type: "string",
      default: "",
      label: "$top Parameter",
    },
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments:
        "The URL to track changes in a driveItem and its children over time. You can also paste here the @odata.nextLink or @odata.deltaLink from a previous response to resume tracking changes.",
      example: "/drives/{drive-id}/root/delta",
      key: "deltaURL",
      type: "string",
      default: "/drives/{drive-id}/root/delta",
      label: "URL to fetch for delta",
    },
  ]}
/>

<hr className="componentActionSeparator" />

<div id="listdrives" />

### List Drives

List all drives within any given SharePoint site | <small><b>key: listDrives</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: false,
      example: "100",
      comments: "Enter a number amount for the page size.",
      key: "pageLimit",
      type: "string",
      default: "",
      label: "Page Limit",
    },
    {
      required: false,
      example: "X%2744537079ghv",
      comments: "Enter the token for the desired page.",
      key: "pageToken",
      type: "string",
      default: "",
      label: "Page Token",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint site.",
      example:
        "example.sharepoint.com,c45de8832-a4969-479d-aeb2-7nAh8321,48bf81d7-2d37-40a9-b47b-c1d1960d00f87",
      key: "siteId",
      type: "string",
      default: "",
      label: "Site Id",
    },
  ]}
/>

#### Output Example Payload

```
{
  "data": {
    "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#drives",
    "value": [
      {
        "createdDateTime": "2023-05-14T05:14:52Z",
        "description": "",
        "id": "b!o2UaIfdNxk-5091VjGz1sDVso2efo6RGrpVCkPpe547Qrf38sox_TYIFuj9QrJhv",
        "lastModifiedDateTime": "2023-05-14T05:14:52Z",
        "name": "Documents",
        "webUrl": "https://example.sharepoint.com/Shared%20Documents",
        "driveType": "documentLibrary",
        "createdBy": {
          "user": {
            "displayName": "System Account"
          }
        },
        "owner": {
          "group": {
            "id": "9705118a-6ce1-4fa3-adba-09f94b69d568",
            "displayName": "9705118a-6ce1-4fa3-acda-09f94b69d446"
          }
        },
        "quota": {
          "deleted": 0,
          "remaining": 27487789251101,
          "state": "normal",
          "total": 27487790694400,
          "used": 1443299
        }
      }
    ]
  }
}
```

<hr className="componentActionSeparator" />

<div id="getfilesfromdrive" />

### List Files in Drive

List all the files from a Drive | <small><b>key: getFilesFromDrive</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint drive.",
      example:
        "b!WumF-zsD8ku93Y0QqhKM9jVTjPefo6RGrpVCkPpe547Qrf38sox_TYIFuj9sqJhv",
      key: "driveId",
      type: "string",
      default: "",
      label: "Drive",
    },
  ]}
/>

<hr className="componentActionSeparator" />

<div id="getfilesfromdrivefolder" />

### List Folder Files in Drive

List all the files inside of a folder from a Drive | <small><b>key: getFilesFromDriveFolder</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint drive.",
      example:
        "b!WumF-zsD8ku93Y0QqhKM9jVTjPefo6RGrpVCkPpe547Qrf38sox_TYIFuj9sqJhv",
      key: "driveId",
      type: "string",
      default: "",
      label: "Drive",
    },
    {
      placeholder: "Folder ID",
      required: false,
      example: "01Q7VXAXZW7LCB32ODBRCKZNSJIC544FXU",
      comments: "Provide the unique identifier of a Sharepoint folder Id.",
      key: "folderId",
      type: "string",
      default: "",
      label: "Folder ID",
    },
  ]}
/>

<hr className="componentActionSeparator" />

<div id="listfollowedsites" />

### List Followed Sites

List all Followed Sites | <small><b>key: listFollowedSites</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: false,
      example: "100",
      comments: "Enter a number amount for the page size.",
      key: "pageLimit",
      type: "string",
      default: "",
      label: "Page Limit",
    },
    {
      required: false,
      example: "X%2744537079ghv",
      comments: "Enter the token for the desired page.",
      key: "pageToken",
      type: "string",
      default: "",
      label: "Page Token",
    },
  ]}
/>

#### Output Example Payload

```
{
  "data": {
    "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#sites",
    "value": [
      {
        "displayName": "Example",
        "id": "example.sharepoint.com,6c44888f-5883-4ef0-c542-d21a802cfea6,ed2d5d06-e192-4047-afa6-a5d7f25b3418",
        "sharepointIds": {
          "siteId": "6c44888f-5883-4ef0-c542-d21a802cfea6",
          "webId": "ed2d5d06-e192-4047-afa6-a5d7f25b3418"
        },
        "siteCollection": {
          "hostname": "example.sharepoint.com"
        },
        "webUrl": "https://example.sharepoint.com/sites/Example"
      }
    ]
  }
}
```

<hr className="componentActionSeparator" />

<div id="getlistitemsinsite" />

### List Items in Site List

Return all items inside the given site list | <small><b>key: getListItemsInSite</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint site list.",
      example: "48bf81d7-2d37-40a9-b47b-c1d1960d00f87",
      key: "listId",
      type: "string",
      default: "",
      label: "List Id",
    },
    {
      required: false,
      example: "name, description, id",
      comments:
        "Provide a comma separated list of fields to overwrite the default result set.",
      key: "optInFields",
      type: "string",
      default: "",
      label: "Opt In Fields",
    },
    {
      required: false,
      example: "100",
      comments: "Enter a number amount for the page size.",
      key: "pageLimit",
      type: "string",
      default: "",
      label: "Page Limit",
    },
    {
      required: false,
      example: "X%2744537079ghv",
      comments: "Enter the token for the desired page.",
      key: "pageToken",
      type: "string",
      default: "",
      label: "Page Token",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint site.",
      example:
        "example.sharepoint.com,c45de8832-a4969-479d-aeb2-7nAh8321,48bf81d7-2d37-40a9-b47b-c1d1960d00f87",
      key: "siteId",
      type: "string",
      default: "",
      label: "Site Id",
    },
  ]}
/>

<hr className="componentActionSeparator" />

<div id="listshareddocuments" />

### List Shared Documents

Lists documents shared with the user. | <small><b>key: listSharedDocuments</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
  ]}
/>

<hr className="componentActionSeparator" />

<div id="listsitelists" />

### List Site Lists

List all Site Lists | <small><b>key: listSiteLists</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint site.",
      example:
        "example.sharepoint.com,c45de8832-a4969-479d-aeb2-7nAh8321,48bf81d7-2d37-40a9-b47b-c1d1960d00f87",
      key: "siteId",
      type: "string",
      default: "",
      label: "Site Id",
    },
  ]}
/>

<hr className="componentActionSeparator" />

<div id="listsites" />

### List Sites

List all SharePoint sites | <small><b>key: listSites</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: false,
      example: "100",
      comments: "Enter a number amount for the page size.",
      key: "pageLimit",
      type: "string",
      default: "",
      label: "Page Limit",
    },
    {
      required: false,
      example: "X%2744537079ghv",
      comments: "Enter the token for the desired page.",
      key: "pageToken",
      type: "string",
      default: "",
      label: "Page Token",
    },
  ]}
/>

#### Output Example Payload

```
{
  "data": {
    "value": [
      {
        "description": "Example description",
        "id": "example.sharepoint.com,c45e332-a998-479d-aeb2-2a",
        "name": "Example SharePoint Site",
        "webUrl": "https://example.sharepoint.com",
        "displayName": "Communication Site",
        "siteCollection": {
          "hostname": "https://example.sharepoint.com"
        }
      }
    ]
  }
}
```

<hr className="componentActionSeparator" />

<div id="listsubscriptions" />

### List Subscriptions

List all available Subscriptions | <small><b>key: listSubscriptions</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: false,
      comments: "Show only subscriptions for this Instance's Subscriptions",
      key: "showInstanceSubscriptions",
      type: "boolean",
      default: true,
      label: "Show Instance Subscriptions",
    },
  ]}
/>

#### Output Example Payload

```
{
  "data": {
    "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#subscriptions",
    "value": [
      {
        "id": "38031b7d-16b1-448a-8e68-68b8aec6df45",
        "resource": "/me/drive/root",
        "applicationId": "0fed8223-8c47-4c71-ba78-92c6f9441235",
        "changeType": "updated",
        "clientState": null,
        "notificationUrl": "https://hooks.prismatic.io/trigger/SW5",
        "notificationQueryOptions": null,
        "lifecycleNotificationUrl": null,
        "expirationDateTime": "2023-07-01T11:23:00Z",
        "creatorId": "62162f3c-04d4-4b39-b2a4-ad891a5dcb8f",
        "includeResourceData": null,
        "latestSupportedTlsVersion": "v1_2",
        "encryptionCertificate": null,
        "encryptionCertificateId": null,
        "notificationUrlAppId": null
      }
    ]
  }
}
```

<hr className="componentActionSeparator" />

<div id="rawrequest" />

### Raw Request

Send raw HTTP request to Microsoft Sharepoint | <small><b>key: rawRequest</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      placeholder: "Data to send",
      required: false,
      comments: "The HTTP body payload to send to the URL.",
      example: '{"exampleKey": "Example Data"}',
      key: "data",
      type: "string",
      default: "",
      label: "Data",
    },
    {
      required: false,
      comments: "Enabling this flag will log out the current request.",
      key: "debugRequest",
      type: "boolean",
      default: "false",
      label: "Debug Request",
    },
    {
      placeholder: "Data to send",
      required: false,
      comments: "File Data to be sent as a multipart form upload.",
      example: '[{key: "example.txt", value: "My File Contents"}]',
      key: "fileData",
      type: "string",
      default: "",
      collection: "keyvaluelist",
      label: "File Data",
    },
    {
      placeholder: "The file name to apply to a file",
      required: false,
      comments:
        "File names to apply to the file data inputs. Keys must match the file data keys above.",
      key: "fileDataFileNames",
      type: "string",
      default: "",
      collection: "keyvaluelist",
      label: "File Data File Names",
    },
    {
      placeholder: "Data to send",
      required: false,
      comments: "The Form Data to be sent as a multipart form upload.",
      example: '[{"key": "Example Key", "value": new Buffer("Hello World")}]',
      key: "formData",
      type: "string",
      default: "",
      collection: "keyvaluelist",
      label: "Form Data",
    },
    {
      placeholder: "Header",
      required: false,
      comments: "A list of headers to send with the request.",
      example: "User-Agent: curl/7.64.1",
      key: "headers",
      type: "string",
      default: "",
      collection: "keyvaluelist",
      label: "Header",
    },
    {
      placeholder: "Max Retries",
      required: false,
      comments: "The maximum number of retries to attempt.",
      key: "maxRetries",
      type: "string",
      default: "0",
      label: "Max Retry Count",
    },
    {
      required: true,
      model: [
        {
          label: "DELETE",
          value: "DELETE",
        },
        {
          label: "GET",
          value: "GET",
        },
        {
          label: "HEAD",
          value: "HEAD",
        },
        {
          label: "LINK",
          value: "LINK",
        },
        {
          label: "OPTIONS",
          value: "OPTIONS",
        },
        {
          label: "PATCH",
          value: "PATCH",
        },
        {
          label: "POST",
          value: "POST",
        },
        {
          label: "PURGE",
          value: "PURGE",
        },
        {
          label: "PUT",
          value: "PUT",
        },
        {
          label: "UNLINK",
          value: "UNLINK",
        },
      ],
      comments: "The HTTP method to use.",
      key: "method",
      type: "string",
      default: "",
      label: "Method",
    },
    {
      placeholder: "Query Parameter",
      required: false,
      comments:
        "A list of query parameters to send with the request. This is the portion at the end of the URL similar to ?key1=value1&key2=value2.",
      key: "queryParams",
      type: "string",
      default: "",
      collection: "keyvaluelist",
      label: "Query Parameter",
    },
    {
      placeholder: "Response Type",
      required: true,
      comments:
        "The type of data you expect in the response. You can request json, text, or binary data.",
      model: [
        {
          label: "arraybuffer",
          value: "arraybuffer",
        },
        {
          label: "document",
          value: "document",
        },
        {
          label: "json",
          value: "json",
        },
        {
          label: "text",
          value: "text",
        },
      ],
      key: "responseType",
      type: "string",
      default: "json",
      label: "Response Type",
    },
    {
      required: false,
      comments:
        "If true, retries on all erroneous responses regardless of type.",
      key: "retryAllErrors",
      type: "boolean",
      default: "false",
      label: "Retry On All Errors",
    },
    {
      placeholder: "Retry Delay",
      required: false,
      comments: "The delay in milliseconds between retries.",
      key: "retryDelayMS",
      type: "string",
      default: "0",
      label: "Retry Delay (ms)",
    },
    {
      required: false,
      comments:
        "The maximum time that a client will await a response to its request",
      example: "2000",
      key: "timeout",
      type: "string",
      default: "",
      label: "Timeout",
    },
    {
      placeholder: "URL to call",
      required: true,
      comments:
        "Input the path only (/me/followedSites), The base URL is already included (https://graph.microsoft.com/v1.0). For example, to connect to https://graph.microsoft.com/v1.0/me/followedSites, only /me/followedSites is entered in this field.",
      example: "/me/followedSites",
      key: "url",
      type: "string",
      default: "",
      label: "URL",
    },
    {
      required: false,
      comments:
        "Specifies whether to use a pre-defined exponential backoff strategy for retries.",
      key: "useExponentialBackoff",
      type: "boolean",
      default: "false",
      label: "Use Exponential Backoff",
    },
  ]}
/>

<hr className="componentActionSeparator" />

<div id="updatefile" />

### Update File

Update a file to the specified drive | <small><b>key: updateFile</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint drive.",
      example:
        "b!WumF-zsD8ku93Y0QqhKM9jVTjPefo6RGrpVCkPpe547Qrf38sox_TYIFuj9sqJhv",
      key: "driveId",
      type: "string",
      default: "",
      label: "Drive",
    },
    {
      required: true,
      comments: "Provide data to be uploaded to your desired SharePoint drive.",
      example: "These are my file contents.",
      key: "fileData",
      type: "data",
      default: "",
      label: "File Data",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint item Id.",
      example: "01Q7VXROAW7LCB32ODBRCKZNSJIC544XAQ",
      key: "itemId",
      type: "string",
      default: "",
      label: "Item Id",
    },
  ]}
/>

<hr className="componentActionSeparator" />

<div id="updatesitelistsubscriptionexpiration" />

### Update Site List Subscription Expiration

Update existing Site List subscription expiration for Microsoft SharePoint | <small><b>key: updateSiteListSubscriptionExpiration</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: false,
      comments:
        "Expiration date/time for subscription. If unspecified the default will be the current date/time plus 29 days (close to the maximum permitted by the Graph API).",
      key: "expirationDateTime",
      type: "string",
      default: "",
      label: "Expiration Date/Time",
    },
    {
      required: true,
      comments: "Subscription ID to manage",
      key: "subscriptionId",
      type: "string",
      default: "",
      label: "Subscription ID",
    },
  ]}
/>

[Subscriptions have an expiration date/time](https://learn.microsoft.com/en-us/graph/api/resources/subscription?view=graph-rest-1.0#maximum-length-of-subscription-per-resource-type) provided upon creation. This can also be modified with the update API. This action will default to adding 29 days (close to the maximum value for SharePoint resources) to the current date/time unless a value is specified. This is useful for "touching" the subscription to ensure its expiration is extended.

#### Output Example Payload

```
{
  "data": {
    "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#subscriptions/$entity",
    "id": "e9d5b726-4478-4412-bfba-268530484566",
    "resource": "sites/example.sharepoint.com,17cd4ada-1a76-420e-a7ec-4adaa3327c86,87742bc7-2d2f-404c-8255-d3d9fa9a6561/lists/3a3c0f6a-86da-4567-94d4-3b939da63200",
    "applicationId": "e76615c0-13e3-4cd2-8235-a2d628ad13de",
    "changeType": "updated",
    "clientState": null,
    "notificationUrl": "https://example.com/webhook/",
    "notificationQueryOptions": null,
    "lifecycleNotificationUrl": null,
    "expirationDateTime": "2022-11-22T23:32:10.231Z",
    "creatorId": "c8edbeda-c453-446c-91ce-c6d5c7310a6c",
    "includeResourceData": null,
    "latestSupportedTlsVersion": "v1_2",
    "encryptionCertificate": null,
    "encryptionCertificateId": null,
    "notificationUrlAppId": null
  }
}
```

<hr className="componentActionSeparator" />

<div id="uploadfile" />

### Upload File

Upload a file to the specified drive or folder's drive | <small><b>key: uploadFile</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments: "Provide the unique identifier of a SharePoint drive.",
      example:
        "b!WumF-zsD8ku93Y0QqhKM9jVTjPefo6RGrpVCkPpe547Qrf38sox_TYIFuj9sqJhv",
      key: "driveId",
      type: "string",
      default: "",
      label: "Drive",
    },
    {
      required: true,
      comments: "Provide data to be uploaded to your desired SharePoint drive.",
      example: "These are my file contents.",
      key: "fileData",
      type: "data",
      default: "",
      label: "File Data",
    },
    {
      required: true,
      comments: "Provide a string value for the name of the new file.",
      example: "reports.csv",
      key: "fileName",
      type: "string",
      default: "",
      label: "File Name",
    },
    {
      placeholder: "Folder ID",
      required: false,
      example: "01Q7VXAXZW7LCB32ODBRCKZNSJIC544FXU",
      comments: "Provide the unique identifier of a Sharepoint folder Id.",
      key: "folderId",
      type: "string",
      default: "",
      label: "Folder ID",
    },
  ]}
/>

<hr className="componentActionSeparator" />
