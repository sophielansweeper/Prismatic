---
id: imap
title: IMAP Component
sidebar_label: IMAP
description: Interact with your IMAP email account. Learn more about using Prismatic's IMAP component.
---

[//]: # "DO NOT EDIT THIS FILE MANUALLY."
[//]: # "This file was auto generated using scripts in docusaurus/scripts/components/"

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

<div className="avatar">
  <div className="avatar__photo-link avatar__photo avatar__photo--lg">
    <img src="/docs/img/components/icons/60/aW1hcA==.png" alt="IMAP" />
  </div>
  <div className="avatar__intro">
    <h4 className="avatar__name">Interact with your IMAP email account</h4>
    <small className="avatar__subtitle">
      Component key: <b>imap</b>
    </small>
  </div>
</div>

## Description

[IMAP](https://en.wikipedia.org/wiki/Internet_Message_Access_Protocol) or Internet Message Access Protocol is an Internet standard protocol used by email clients to retrieve email messages from a mail server over a TCP/IP connection.
This component allows you to interact with mailboxes and messages on any IMAP server.

Further information can be found in the [underlying Node library's documentation](https://imapflow.com/module-imapflow-ImapFlow.html#getMailboxLock).

## Connections

### IMAP Connection

To configure a connection to an IMAP server you will need a few properties:

- The host and port of your IMAP server
- A set of login credentials for a user that exists on the IMAP server
- The version of encryption the IMAP server is compatible with.

The setup can vary widely depending on the email service you are using.
We have provided a bit of context around some popular services to get you started.

#### Connecting to Gmail

To set up an IMAP connection to your Gmail account, you need to create a [Google App Password](https://support.google.com/accounts/answer/185833?hl=en).
Go to your [Google Account](https://myaccount.google.com/) and select 'Security'.
Under "Signing in to Google," select App Passwords. You may need to sign in.

If you don't have this option, it might be because:

- 2 Step Verification is not set up for your account.
- 2 Step Verification is only set up for security keys.
- Your account is through work, school, or other organization.
- You turned on Advanced Protection.

At the bottom, click **Select App** and choose **Mail**, and then click **Select device** and choose **Other (Custom name)**.
Then, click **GENERATE**.
You'll be given a 16-character code, which is your **app password**.
Copy that somewhere safe.

Finally, create a connection in Prismatic and provide these values:

- Enter `imap.gmail.com` for the host
- The default values for port and security are fine
- Enter the username or email of your Gmail account
- Enter the **app password** you created earlier

If you run into authentication problems, ensure that your account has [IMAP enabled](https://support.google.com/mail/answer/7126229).

#### Connecting to Microsoft Office 365

If your Office 365 domain does not use multi-factor authentication (this is rare), then you can use your username and password to authenticate.

If MFA is enabled, you will need to create an **app password** to authenticate.
To create an app password, log in to the [Microsoft Security Center](https://mysignins.microsoft.com/security-info) and open the **Security info** tab.
Click **+Add method** and choose **App password**.

If you don't have an **app password** option, you'll need to contact your Office 365 administrator and have them [enable it](https://support.microsoft.com/en-us/account-billing/manage-app-passwords-for-two-step-verification-d6dc8c6d-4bf7-4851-ad95-6d07799387e9).

Give your app password a name, and copy the password that is generated.

Now, create a connection in Prismatic and provide these values:

- Enter `outlook.office365.com` for the host
- The default values for port and security are fine
- Enter the username or email of your Outlook account
- Enter your password or the app password you generated

**On-prem enabled**: this connection can be configured to connect to an on-prem resource on a private network. [Learn more](on-prem-agent.mdx).

<ComponentInputsTable
  inputs={[
    {
      placeholder: "Host",
      required: true,
      shown: true,
      comments: "Provide the host address for the desired IMAP server.",
      example: "imap.example.com",
      onPremiseControlled: true,
      key: "host",
      type: "string",
      default: "",
      label: "Host",
    },
    {
      required: true,
      shown: true,
      comments: "Provide a valid TLS version to be used in the connection.",
      example: "TLSv1.3",
      model: [
        {
          label: "TLSv1.1",
          value: "TLSv1.1",
        },
        {
          label: "TLSv1.2",
          value: "TLSv1.2",
        },
        {
          label: "TLSv1.3",
          value: "TLSv1.3",
        },
      ],
      key: "maxVersion",
      type: "string",
      default: "TLSv1.3",
      label: "Maximum TLS Version",
    },
    {
      required: true,
      shown: true,
      comments: "Minimum size of bits to accept in a TLS connection",
      example: "512",
      key: "minDHSize",
      type: "string",
      default: "1024",
      label: "Min DH Size",
    },
    {
      required: true,
      shown: true,
      comments: "Provide a valid TLS version to be used in the connection.",
      example: "TLSv1.1",
      model: [
        {
          label: "TLSv1.1",
          value: "TLSv1.1",
        },
        {
          label: "TLSv1.2",
          value: "TLSv1.2",
        },
        {
          label: "TLSv1.3",
          value: "TLSv1.3",
        },
      ],
      key: "minVersion",
      type: "string",
      default: "TLSv1.1",
      label: "Minimum TLS Version",
    },
    {
      placeholder: "Password",
      required: false,
      shown: true,
      comments:
        "Provide the password for the given user. This value is required if secured is set to true.",
      example: "examplePassword",
      key: "pass",
      type: "password",
      default: "",
      label: "Password",
    },
    {
      placeholder: "Port",
      required: true,
      shown: true,
      comments: "Provide the port for the desired IMAP server.",
      example: "993",
      onPremiseControlled: true,
      key: "port",
      type: "string",
      default: "993",
      label: "Port",
    },
    {
      placeholder: "Secure",
      required: true,
      shown: true,
      comments: "Determines if the connection is secure.",
      key: "secure",
      type: "boolean",
      default: "true",
      label: "Secure",
    },
    {
      placeholder: "Username",
      required: true,
      shown: true,
      comments: "Provide a valid username or email.",
      example: "someone@example.com",
      key: "user",
      type: "string",
      default: "",
      label: "Username",
    },
  ]}
/>

## Data Sources

<div id="listmailboxes" />

### List Mailboxes

Returns a picklist of available mailboxes that users can choose from | <small><b>key: listMailboxes</b></small> | <small><b>type: picklist</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
  ]}
/>

<hr className="componentActionSeparator" />

## Actions

<div id="addflags" />

### Add Flags

Add new flags to an existing message | <small><b>key: addFlags</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments:
        "For each item, provide a string value to be added to an existing message.",
      example: "exampleFlag",
      key: "flags",
      type: "string",
      default: "",
      collection: "valuelist",
      label: "Flags",
    },
    {
      required: true,
      comments: "Provide a string value for the name of the mailbox",
      example: "INBOX",
      key: "mailbox",
      type: "string",
      default: "",
      label: "Mailbox",
    },
    {
      required: true,
      comments:
        "Provide a range of messages. Alternatively you can specify * to get the latest message",
      example: "1,2,4:6",
      key: "range",
      type: "string",
      default: "",
      label: "Range",
    },
  ]}
/>

<hr className="componentActionSeparator" />

<div id="appendmessage" />

### Append Message

Appends a new message to an existing mailbox | <small><b>key: appendMessage</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments: "Mailbox path to upload the message to",
      example:
        "\n  From: someone@<yourcompany>.com\n  Subject: A basic RFC 850 formatted message\n  Newsgroups: comp.<yourcompany>.test\n\n  The body of this message is plain text. Note the blank line\n  between the header information and the body of the message.\n  ",
      key: "content",
      type: "string",
      default: "",
      label: "Message Content",
    },
    {
      required: true,
      comments: "Provide a string value for the name of the mailbox",
      example: "INBOX",
      key: "mailbox",
      type: "string",
      default: "",
      label: "Mailbox",
    },
    {
      required: true,
      comments: "Mailbox path to upload the message to",
      example: "INBOX",
      key: "path",
      type: "string",
      default: "",
      label: "Path",
    },
  ]}
/>

<hr className="componentActionSeparator" />

<div id="copymessage" />

### Copy Message

Copies a message from one mailbox to another. | <small><b>key: copyMessage</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments: "Provide a string value for the name of the mailbox",
      example: "INBOX",
      key: "mailbox",
      type: "string",
      default: "",
      label: "Mailbox",
    },
    {
      required: true,
      comments: "Mailbox path to upload the message to",
      example: "INBOX",
      key: "path",
      type: "string",
      default: "",
      label: "New Path",
    },
    {
      required: true,
      comments:
        "Provide a range of messages. Alternatively you can specify * to get the latest message",
      example: "1,2,4:6",
      key: "range",
      type: "string",
      default: "",
      label: "Range",
    },
  ]}
/>

#### Output Example Payload

```
{
  "data": {
    "path": "My-Source-Mailbox",
    "destination": "My-Destination-Mailbox",
    "uidValidity": "596391920",
    "uidMap": []
  }
}
```

<hr className="componentActionSeparator" />

<div id="createmailbox" />

### Create Mailbox

Creates a new mailbox folder and sets up subscription for the created mailbox | <small><b>key: createMailbox</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments: "Mailbox path to upload the message to",
      example: "INBOX",
      key: "path",
      type: "string",
      default: "",
      label: "Path",
    },
  ]}
/>

<hr className="componentActionSeparator" />

<div id="deletemessage" />

### Delete Message

Delete an existing message | <small><b>key: deleteMessage</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments: "Provide a string value for the name of the mailbox",
      example: "INBOX",
      key: "mailbox",
      type: "string",
      default: "",
      label: "Mailbox",
    },
    {
      example: "5",
      comments: "The UID of the message.",
      key: "messageIndex",
      type: "string",
      default: "",
      label: "Message UID",
    },
  ]}
/>

#### Output Example Payload

```
{
  "data": true
}
```

<hr className="componentActionSeparator" />

<div id="downloadmessage" />

### Download Message

Download either full RFC-822 formatted message or a specific body structure part | <small><b>key: downloadMessage</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments: "Provide a string value for the name of the mailbox",
      example: "INBOX",
      key: "mailbox",
      type: "string",
      default: "",
      label: "Mailbox",
    },
    {
      example: "5",
      comments:
        "The index of the message you would like to download (1 for the oldest message, 2 for second oldest, etc), or the ID of the message.",
      key: "messageIndex",
      type: "string",
      default: "",
      label: "Message Index or ID",
    },
  ]}
/>

<hr className="componentActionSeparator" />

<div id="getstatus" />

### Get Mailbox Status

Returns the status of a mailbox's properties | <small><b>key: getStatus</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments: "Provide a string value for the name of the mailbox",
      example: "INBOX",
      key: "mailbox",
      type: "string",
      default: "",
      label: "Mailbox",
    },
  ]}
/>

#### Output Example Payload

```
{
  "data": {
    "path": "INBOX",
    "highestModseq": "10914782",
    "messages": 61,
    "recent": 0,
    "uidNext": 76791,
    "uidValidity": "596391842",
    "unseen": 41
  }
}
```

<hr className="componentActionSeparator" />

<div id="listmailboxes" />

### List Mailboxes

Returns a list of available mailboxes | <small><b>key: listMailboxes</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
  ]}
/>

#### Output Example Payload

```
{
  "data": [
    {
      "path": "Drafts",
      "pathAsListed": "Drafts",
      "flags": {},
      "delimiter": "/",
      "listed": true,
      "parentPath": "",
      "parent": [],
      "name": "Drafts",
      "subscribed": true
    },
    {
      "path": "INBOX",
      "pathAsListed": "INBOX",
      "flags": {},
      "delimiter": "/",
      "listed": true,
      "specialUse": "\\Inbox",
      "parentPath": "",
      "parent": [],
      "name": "INBOX",
      "subscribed": true
    },
    {
      "path": "Sent",
      "pathAsListed": "Sent",
      "flags": {},
      "delimiter": "/",
      "listed": true,
      "parentPath": "",
      "parent": [],
      "name": "Sent",
      "subscribed": true
    }
  ]
}
```

<hr className="componentActionSeparator" />

<div id="removeflags" />

### Remove Flags From Message

Remove existing flags from an existing message | <small><b>key: removeFlags</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments:
        "For each item, provide a string value to be added to an existing message.",
      example: "exampleFlag",
      key: "flags",
      type: "string",
      default: "",
      collection: "valuelist",
      label: "Flags",
    },
    {
      required: true,
      comments: "Provide a string value for the name of the mailbox",
      example: "INBOX",
      key: "mailbox",
      type: "string",
      default: "",
      label: "Mailbox",
    },
    {
      required: true,
      comments:
        "Provide a range of messages. Alternatively you can specify * to get the latest message",
      example: "1,2,4:6",
      key: "range",
      type: "string",
      default: "",
      label: "Range",
    },
  ]}
/>

<hr className="componentActionSeparator" />

<div id="renamemailbox" />

### Rename Mailbox

Change the name of an existing mailbox | <small><b>key: renameMailbox</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments: "Mailbox path to upload the message to",
      example: "INBOX",
      key: "newPath",
      type: "string",
      default: "",
      label: "New Path",
    },
    {
      required: true,
      comments: "Mailbox path to upload the message to",
      example: "INBOX",
      key: "path",
      type: "string",
      default: "",
      label: "Path",
    },
  ]}
/>

<hr className="componentActionSeparator" />

<div id="searchmailbox" />

### Search / List Mailbox Messages

Returns all messages in the given mailbox | <small><b>key: searchMailbox</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: false,
      comments: "Filter email messages by sender",
      example: "someone@example.com",
      key: "from",
      type: "string",
      default: "",
      label: "From",
    },
    {
      required: true,
      comments: "Provide a string value for the name of the mailbox",
      example: "INBOX",
      key: "mailbox",
      type: "string",
      default: "",
      label: "Mailbox",
    },
    {
      required: true,
      model: [
        {
          label: "Show all messages",
          value: "all",
        },
        {
          label: "Show only unread messages",
          value: "unread",
        },
        {
          label: "Show only read messages",
          value: "read",
        },
      ],
      key: "readUnread",
      type: "string",
      default: "all",
      label: "Read / Unread Filter",
    },
    {
      required: false,
      comments: "Filter email messages by recipient",
      example: "someone@example.com",
      key: "to",
      type: "string",
      default: "",
      label: "To",
    },
  ]}
/>

<hr className="componentActionSeparator" />

<div id="setflags" />

### Set Flags

Set a value for an existing message flag | <small><b>key: setFlags</b></small>

<ComponentInputsTable
  inputs={[
    {
      required: true,
      key: "connection",
      type: "connection",
      label: "Connection",
    },
    {
      required: true,
      comments:
        "For each item, provide a string value to be added to an existing message.",
      example: "exampleFlag",
      key: "flags",
      type: "string",
      default: "",
      collection: "valuelist",
      label: "Flags",
    },
    {
      required: true,
      comments: "Provide a string value for the name of the mailbox",
      example: "INBOX",
      key: "mailbox",
      type: "string",
      default: "",
      label: "Mailbox",
    },
    {
      required: true,
      comments:
        "Provide a range of messages. Alternatively you can specify * to get the latest message",
      example: "1,2,4:6",
      key: "range",
      type: "string",
      default: "",
      label: "Range",
    },
  ]}
/>

<hr className="componentActionSeparator" />
